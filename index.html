<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Blackjack: –®—É—Ä–∏–∫ –ø—Ä–æ—Ç–∏–≤ –ö—É—Ä–∏—Ü—ã</title>
  <style>
    :root { --radius: 16px; --shadow: 0 12px 24px rgba(0,0,0,0.15); }
    *{box-sizing:border-box;}
    body {margin:0; font-family: system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,sans-serif; background: linear-gradient(135deg,#2a2f4a 0%,#1f2a3e 60%); color:#f0f2fa; min-height:100vh; display:flex; align-items:center; justify-content:center; padding:1rem; }
    .game {width:100%; max-width:1000px; background: radial-gradient(circle at 50% 20%, #2f3d67, #1f2947 80%); border-radius:22px; padding:1rem 1rem 2rem; position:relative; overflow:hidden; box-shadow:0 30px 60px rgba(0,0,0,0.4); }
    .top-bar {display:flex; flex-wrap:wrap; gap:1rem; justify-content:space-between; align-items:center;}
    .title {font-size:1.6rem; font-weight:700; display:flex; gap:.5rem; align-items:center;}
    .subtitle {font-size:.9rem; color:#c0c8ff;}
    .players {display:flex; flex-wrap:wrap; gap:1rem; margin-top:0.75rem;}
    .panel {background:rgba(255,255,255,0.05); border:1px solid rgba(255,255,255,0.1); border-radius:18px; padding:1rem; flex:1 1 260px; position:relative;}
    .dealer-area, .player-area{display:flex; flex-direction:column; gap:.5rem;}
    .cards {display:flex; gap: -14px; margin-top:6px; position:relative;}
    .card {width:72px; height:100px; border-radius:12px; background:#fff; position:relative; display:flex; flex-direction:column; justify-content:space-between; padding:6px; font-size:14px; font-weight:600; color:#222; box-shadow:0 12px 30px rgba(0,0,0,0.25); transform-origin:center; transition:transform .35s ease, opacity .35s ease;}
    .card.back {background: linear-gradient(135deg,#444c7a,#2a3259); color:#fff;}
    .card .corner {display:flex; flex-direction:column;}
    .suit {font-size:1.1rem;}
    .value {display:inline-block;}
    .controls {margin-top:10px; display:flex; gap:10px; flex-wrap:wrap;}
    button {cursor:pointer; padding:10px 18px; border:none; border-radius:12px; font-weight:600; background:#ffcf3f; color:#1c1c2e; position:relative; overflow:hidden; box-shadow:0 12px 28px rgba(255,207,63,0.5); transition:filter .2s;}
    button:hover{filter:brightness(1.05);}    
    .small {font-size:.75rem;}
    .message {margin-top:6px; background:rgba(255,255,255,0.08); padding:8px 14px; border-radius:10px; font-size:.9rem; display:inline-block;}
    .score {font-size:1rem; font-weight:700;}
    .status {margin-top:4px; font-size:.9rem;}
    .flex {display:flex; align-items:center; gap:8px;}
    .chicken-wrapper {display:flex; align-items:center; gap:10px;}
    .chicken {width:110px; height:140px; position:relative;}
    /* Chicken SVG container styling for animation trigger */
    .speech {position:absolute; top:-10px; left:100px; background:#ffeaa7; padding:8px 14px; border-radius:14px; font-size:.75rem; color:#2d2d3a; box-shadow:0 10px 30px rgba(0,0,0,0.2);}
    .badge {background:#ff6b6b; padding:4px 10px; border-radius:10px; font-size:.6rem; text-transform:uppercase; letter-spacing:1px;}
    .result-box {margin-top:10px; background:rgba(255,255,255,0.07); padding:12px 18px; border-radius:14px; font-size:1rem; font-weight:600;}
    .hidden {visibility:hidden;}
    .footer {margin-top:1.2rem; display:flex; flex-wrap:wrap; gap:10px; justify-content:space-between; font-size:.7rem;}
    .bg-table{position:absolute; inset:0; pointer-events:none; background: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwMCIgaGVpZ2h0PSIxNTAwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgogIDxnIG9wYWNpdHk9Ii4zIj4KICAgIDxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIyMDAwIiBoZWlnaHQ9IjE1MDAiIGZpbGw9IiMwMTEyMjYiIC8+CiAgICA8ZyBmaWxsPSIjMzQ0Zjg2Ij4KICAgICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjIwMDAiIGhlaWdodD0iMjAiIC8+CiAgICAgIDxyZWN0IHg9IjAiIHk9IjQwIiB3aWR0aD0iMjAwMCIgaGVpZ2h0PSIyMCIgLz4KICAgICAgPHJlY3QgeD0iMCIgeT0iIj4KICAgICAgICA8YW5pbWF0ZSBhdHRyaWJ1dGVOYW1lPSJ5IiBiZWdpbj0iMCIgZHVyPSIxM2MiIHZhbHVlcz0iMCA7IDEwMDAiIHJlcGVhdENvdW50PSJpbmRlZmF0ZSIgLz4KICAgICAgPC9yZWN0PgogICAgPC9nPgogIDwvZz4KPC9zdmc+'); background-size:cover; mix-blend-mode:overlay; }
    @media (max-width: 950px){.title{font-size:1.3rem;} .card{width:60px; height:84px;} }
    @keyframes flap {0%{transform: rotate(0deg);}50%{transform: rotate(15deg);}100%{transform: rotate(0deg);} }
    .wing {transform-origin:top center; animation:flap 0.6s ease-in-out infinite;}
    .deal-animate {animation:deal-move .5s ease forwards;}
    @keyframes deal-move {from{transform: translateY(-25px) scale(.85);} to{transform: translateY(0) scale(1);} }
    .shake {animation:shake 0.4s ease-in-out;}
    @keyframes shake {0%{transform:translateX(0);}25%{transform:translateX(-3px);}50%{transform:translateX(3px);}75%{transform:translateX(-2px);}100%{transform:translateX(0);} }
    .btn-group{display:flex; gap:8px; flex-wrap:wrap;}
  </style>
</head>
<body>
  <div class="game" role="application" aria-label="Blackjack —Å –∫—É—Ä–∏—Ü–µ–π-–∫—Ä—É–ø—å–µ">
    <div class="bg-table"></div>
    <div class="top-bar">
      <div class="title">üÉè Blackjack: –®—É—Ä–∏–∫ vs –ö—É—Ä–∏—Ü–∞</div>
      <div class="subtitle">–ò–≥—Ä–∞–π, –ø–æ–±–µ–∂–¥–∞–π, –Ω–µ –∑–∞–±—ã–≤–∞–π: —É –∫—É—Ä–∏—Ü—ã –µ—Å—Ç—å —á—É–≤—Å—Ç–≤–æ —é–º–æ—Ä–∞!</div>
    </div>
    <div class="players">
      <div class="panel dealer-area" aria-label="–ö—Ä—É–ø—å–µ">
        <div class="flex">
          <div class="badge">–ö—Ä—É–ø—å–µ</div>
          <div class="chicken-wrapper">
            <div class="chicken" aria-label="–ö—É—Ä–∏—Ü–∞-–∫—Ä—É–ø—å–µ">
              <!-- SVG –∫—É—Ä–∏—Ü—ã -->
              <svg viewBox="0 0 160 180" width="100%" height="100%" aria-hidden="true">
                <!-- —Ç–µ–ª–æ -->
                <ellipse cx="80" cy="110" rx="50" ry="55" fill="#ffe699" />
                <!-- –≥–æ–ª–æ–≤–∞ -->
                <circle cx="80" cy="60" r="35" fill="#ffe699" />
                <!-- –≥–ª–∞–∑–∞ -->
                <circle cx="68" cy="55" r="6" fill="#222" />
                <circle cx="92" cy="55" r="6" fill="#222" />
                <!-- –∫–ª—é–≤ -->
                <polygon points="80,70 70,80 90,80" fill="#ff9f43" />
                <!-- –≥—Ä–µ–±–µ–Ω—å -->
                <path d="M60,42 q10 -25 20 0 q10 -25 20 0 q10 -25 20 0" fill="#ff5f5f" />
                <!-- –∫—Ä—ã–ª—å—è -->
                <g class="wing" transform="translate(25,100)">
                  <ellipse cx="40" cy="10" rx="25" ry="40" fill="#fff3d9" />
                </g>
                <g class="wing" transform="translate(65,100) scale(-1,1)">
                  <ellipse cx="40" cy="10" rx="25" ry="40" fill="#fff3d9" />
                </g>
                <!-- –Ω–æ–≥–∏ -->
                <rect x="65" y="160" width="6" height="14" fill="#ff9f43" />
                <rect x="89" y="160" width="6" height="14" fill="#ff9f43" />
              </svg>
              <div class="speech" id="chicken-speech">–ü—Ä–∏–≤–µ—Ç, –®—É—Ä–∏–∫! –ì–æ—Ç–æ–≤ –ø—Ä–æ–∏–≥—Ä–∞—Ç—å?</div>
            </div>
          </div>
        </div>
        <div class="status">–ö—Ä—É–ø—å–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç: <span id="dealer-score">?</span></div>
        <div class="cards" aria-label="–ö–∞—Ä—Ç—ã –∫—Ä—É–ø—å–µ" id="dealer-cards"></div>
        <div class="result-box" id="dealer-result">&nbsp;</div>
      </div>
      <div class="panel player-area" aria-label="–ò–≥—Ä–æ–∫ –®—É—Ä–∏–∫">
        <div class="flex">
          <div class="badge">–ò–≥—Ä–æ–∫</div>
          <div style="margin-left:6px; font-weight:700;">–®—É—Ä–∏–∫</div>
        </div>
        <div class="score">–°—á—ë—Ç: <span id="player-score">0</span></div>
        <div class="cards" aria-label="–ö–∞—Ä—Ç—ã –∏–≥—Ä–æ–∫–∞" id="player-cards"></div>
        <div class="controls">
          <div class="btn-group">
            <button id="btn-hit">–í–∑—è—Ç—å</button>
            <button id="btn-stand">–°—Ç–æ–ø</button>
            <button id="btn-new">–ù–æ–≤–∞—è</button>
          </div>
        </div>
        <div class="result-box" id="player-result">&nbsp;</div>
      </div>
    </div>
    <div class="message" id="log">–ù–∞–∂–º–∏ "–ù–æ–≤–∞—è", —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –∏–≥—Ä—É.</div>
    <div class="footer">
      <div>–ü—Ä–æ—Ç–æ—Ç–∏–ø Blackjack. –ú–æ–±–∏–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è —á–µ—Ä–µ–∑ flex –∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã.</div>
      <div>¬© –ö—É—Ä–∏—Ü–∞-–∫—Ä—É–ø—å–µ. –®—É—Ä–∏–∫ ‚Äî —á–µ–º–ø–∏–æ–Ω –≤ –æ–±—É—á–µ–Ω–∏–∏.</div>
    </div>
  </div>

  <template id="card-template">
    <div class="card">
      <div class="corner top"><div class="value"></div><div class="suit"></div></div>
      <div class="center suit-large"></div>
      <div class="corner bottom" style="transform: rotate(180deg);"><div class="value"></div><div class="suit"></div></div>
    </div>
  </template>

  <script>
    // –ö–∞—Ä—Ç—ã –∏ –∑–Ω–∞—á–µ–Ω–∏—è
    const suits = ['‚ô†','‚ô•','‚ô¶','‚ô£'];
    const values = ['A','2','3','4','5','6','7','8','9','10','J','Q','K'];
    let deck = [];
    let playerHand = [];
    let dealerHand = [];
    let inRound = false;

    const playerCardsEl = document.getElementById('player-cards');
    const dealerCardsEl = document.getElementById('dealer-cards');
    const playerScoreEl = document.getElementById('player-score');
    const dealerScoreEl = document.getElementById('dealer-score');
    const logEl = document.getElementById('log');
    const playerResultEl = document.getElementById('player-result');
    const dealerResultEl = document.getElementById('dealer-result');
    const chickenSpeech = document.getElementById('chicken-speech');

    document.getElementById('btn-new').addEventListener('click', startGame);
    document.getElementById('btn-hit').addEventListener('click', playerHit);
    document.getElementById('btn-stand').addEventListener('click', playerStand);

    function createDeck(){
      const d = [];
      for(const s of suits){
        for(const v of values){
          d.push({suit:s, value:v});
        }
      }
      return d;
    }
    function shuffle(array){
      for(let i=array.length-1;i>0;i--){
        const j=Math.floor(Math.random()*(i+1));
        [array[i],array[j]]=[array[j],array[i]];
      }
      return array;
    }
    function cardValue(card){
      if(card.value==='A') return 11;
      if(['J','Q','K'].includes(card.value)) return 10;
      return parseInt(card.value);
    }
    function computeBestScore(hand){
      let total=0; let aces=0;
      for(const c of hand){
        if(c.value==='A'){aces++; total+=11;} else if(['J','Q','K'].includes(c.value)){total+=10;} else {total+=parseInt(c.value);}      
      }
      while(total>21 && aces>0){total-=10; aces--;}
      return total;
    }
    function renderCard(cardObj, hidden=false){
      const template = document.getElementById('card-template');
      const el = template.content.firstElementChild.cloneNode(true);
      if(hidden){
        el.classList.add('back');
        el.innerHTML = '';
        el.textContent = '';
        return el;
      }
      el.querySelectorAll('.value').forEach(x=>x.textContent=cardObj.value);
      el.querySelectorAll('.suit').forEach(x=>x.textContent=cardObj.suit);
      el.querySelector('.suit-large').textContent=cardObj.suit;
      if(cardObj.suit==='‚ô•' || cardObj.suit==='‚ô¶'){
        el.style.color='#d4477a';
      }
      return el;
    }

    function dealCard(toPlayer=true, hidden=false){
      if(deck.length===0) deck = shuffle(createDeck());
      const card = deck.pop();
      if(toPlayer){
        playerHand.push(card);
        const cardEl = renderCard(card,false);
        cardEl.classList.add('deal-animate');
        playerCardsEl.appendChild(cardEl);
      } else {
        dealerHand.push(card);
        const cardEl = hidden ? renderCard(card, true) : renderCard(card,false);
        cardEl.classList.add('deal-animate');
        dealerCardsEl.appendChild(cardEl);
      }
      updateScores();
    }

    function updateScores(){
      playerScoreEl.textContent=computeBestScore(playerHand);
      const showingDealer = dealerCardsEl.children.length>0;
      if(showingDealer){
        // –ø–µ—Ä–≤–∞—è –∫–∞—Ä—Ç–∞
        let shown = [];
        if(dealerHand.length>0){
          // –µ—Å–ª–∏ —Å–∫—Ä—ã—Ç–∞ –≤—Ç–æ—Ä–∞—è
          if(dealerCardsEl.children[1] && dealerCardsEl.children[1].classList.contains('back')){
            shown = [dealerHand[0]]; // —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤–∞—è
          } else {shown = dealerHand;}
        }
        dealerScoreEl.textContent=computeBestScore(shown);
      }
    }

    function clearTable(){
      playerHand = [];
      dealerHand = [];
      playerCardsEl.innerHTML='';
      dealerCardsEl.innerHTML='';
      playerResultEl.textContent='';
      dealerResultEl.textContent='';
      dealerScoreEl.textContent='?';
      playerScoreEl.textContent='0';
    }

    function startGame(){
      if(inRound){
        showLog('–ò–≥—Ä–∞ —É–∂–µ –∏–¥—ë—Ç. –°–±—Ä–æ—Å...');
      }
      inRound=true;
      clearTable();
      deck = shuffle(createDeck());
      dealCard(true);
      dealCard(true);
      dealCard(false);
      dealCard(false,true); // –∑–∞–∫—Ä—ã—Ç–∞—è –∫–∞—Ä—Ç–∞
      showLog('–•–æ–¥ –®—É—Ä–∏–∫–∞: –≤–∑—è—Ç—å –∏–ª–∏ —Å—Ç–æ–ø?');
      chickenSay('–ì–æ—Ç–æ–≤—å—Å—è, –®—É—Ä–∏–∫, –∫—É—Ä–∏—Ü–∞ –Ω–∞–±–ª—é–¥–∞–µ—Ç!');
      checkPlayerBlackjack();
    }

    function playerHit(){
      if(!inRound) return;
      dealCard(true);
      showLog('–®—É—Ä–∏–∫ –±–µ—Ä—ë—Ç –∫–∞—Ä—Ç—É...');
      if(computeBestScore(playerHand)>21){
        endRound('player-bust');
      }
    }

    function playerStand(){
      if(!inRound) return;
      showLog('–®—É—Ä–∏–∫ –æ—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è. –•–æ–¥ –∫—É—Ä–∏—Ü—ã...');
      revealDealerHidden();
      dealerPlay();
    }

    function revealDealerHidden(){
      if(dealerCardsEl.children[1] && dealerCardsEl.children[1].classList.contains('back')){
        dealerCardsEl.children[1].replaceWith(renderCard(dealerHand[1],false));
      }
      updateScores();
    }

    function dealerPlay(){
      let score = computeBestScore(dealerHand);
      while(score < 17){
        dealCard(false);
        score = computeBestScore(dealerHand);
      }
      setTimeout(()=>{
        evaluateWinner();
      }, 400);
    }

    function evaluateWinner(){
      const playerScore = computeBestScore(playerHand);
      const dealerScore = computeBestScore(dealerHand);
      if(dealerScore>21){
        endRound('dealer-bust');
      } else if(playerScore>21){
        endRound('player-bust');
      } else if(playerScore>dealerScore){
        endRound('player-win');
      } else if(playerScore<dealerScore){
        endRound('dealer-win');
      } else {endRound('push');}
    }

    function checkPlayerBlackjack(){
      const score = computeBestScore(playerHand);
      if(score===21){
        showLog('–£ –®—É—Ä–∏–∫–∞ –±–ª—ç–∫–¥–∂–µ–∫!');
        setTimeout(()=>{ playerStand(); },350);
      }
    }

    function endRound(reason){
      inRound=false;
      const playerScore=computeBestScore(playerHand);
      const dealerScore=computeBestScore(dealerHand);
      let msg='';
      switch(reason){
        case 'player-bust': msg='–®—É—Ä–∏–∫ –ø–µ—Ä–µ–±—Ä–∞–ª ‚Äî –ö—É—Ä–∏—Ü–∞ –ø–æ–±–µ–∂–¥–∞–µ—Ç!'; chickenSay('–•–∞! –Ø –∑–Ω–∞–ª–∞, —á—Ç–æ —Ç—ã –Ω–µ –≤—ã—Ç—è–Ω–µ—à—å!'); playerResultEl.textContent='–ü—Ä–æ–∏–≥—Ä—ã—à'; dealerResultEl.textContent='–ü–æ–±–µ–¥–∞'; break;
        case 'dealer-bust': msg='–ö—É—Ä–∏—Ü–∞ –ø–µ—Ä–µ–±—Ä–∞–ª–∞ ‚Äî –®—É—Ä–∏–∫ –ø–æ–±–µ–∂–¥–∞–µ—Ç!'; chickenSay('–ß—Ç–æ–æ–æ? –¢—ã –ø–æ–±–µ–¥–∏–ª –º–µ–Ω—è, –®—É—Ä–∏–∫!'); playerResultEl.textContent='–ü–æ–±–µ–¥–∞'; dealerResultEl.textContent='–ü—Ä–æ–∏–≥—Ä—ã—à'; break;
        case 'player-win': msg='–®—É—Ä–∏–∫ –≤—ã–∏–≥—Ä—ã–≤–∞–µ—Ç!'; chickenSay('–ù—É, –ª–∞–¥–Ω–æ... –ù–æ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ —è –æ—Ç–æ–º—â—É.'); playerResultEl.textContent='–ü–æ–±–µ–¥–∞'; dealerResultEl.textContent='–ü—Ä–æ–∏–≥—Ä—ã—à'; break;
        case 'dealer-win': msg='–ö—É—Ä–∏—Ü–∞ –ø–æ–±–µ–∂–¥–∞–µ—Ç!'; chickenSay('–ö—É—Ä–æ—á–∫–∞ –∑–Ω–∞–µ—Ç —Å–≤–æ–∏ –∫–∞—Ä—Ç—ã.'); playerResultEl.textContent='–ü—Ä–æ–∏–≥—Ä—ã—à'; dealerResultEl.textContent='–ü–æ–±–µ–¥–∞'; break;
        case 'push': msg='–ù–∏—á—å—è!'; chickenSay('–ù–∏—á—å—è? –ú—ã —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ —Å—ã–≥—Ä–∞–ª–∏.'); playerResultEl.textContent='–ù–∏—á—å—è'; dealerResultEl.textContent='–ù–∏—á—å—è'; break;
      }
      revealDealerHidden();
      showLog(msg + ` (–®—É—Ä–∏–∫: ${playerScore}, –ö—É—Ä–∏—Ü–∞: ${dealerScore})`);
      animateChickenReaction(reason);
    }

    function showLog(t){
      logEl.textContent=t;
    }

    function chickenSay(text){
      chickenSpeech.textContent=text;
      chickenSpeech.classList.add('shake');
      setTimeout(()=>{ chickenSpeech.classList.remove('shake'); },500);
    }

    function animateChickenReaction(reason){
      const chickenSvg = document.querySelector('.chicken svg');
      if(reason === 'player-win' || reason==='dealer-bust'){
        // —Å—á–∞—Å—Ç–ª–∏–≤–∞—è –∫—É—Ä–∏—Ü–∞ --> –ø–æ–∫–∞—á–∏–≤–∞–Ω–∏–µ
        chickenSvg.classList.add('shake');
        setTimeout(()=>{chickenSvg.classList.remove('shake');},600);
      } else if(reason === 'dealer-win' || reason==='player-bust'){
        // –∫—É—Ä–∏—Ü–∞ –ø–æ–¥–º–∏–≥–Ω–µ—Ç (–Ω–µ–±–æ–ª—å—à–∞—è –∞–Ω–∏–º–∞—Ü–∏—è)
        // –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç –ø–æ–∑–∂–µ
      }
    }

    // –ö–ª–∞–≤–∏—à–∏ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞
    document.addEventListener('keydown', e=>{
      if(e.key==='h' || e.key==='H') playerHit();
      if(e.key==='s' || e.key==='S') playerStand();
      if(e.key==='n' || e.key==='N') startGame();
    });
  </script>
</body>
</html>
